# –ü—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

–ü–æ–≥–æ–≤–æ—Ä–∏–º –æ —Ç–æ–º, –∫–∞–∫ –¥–∞–Ω–Ω—ã–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –ø–∞–º—è—Ç–∏.

## –¶–µ–ª—ã–µ —á–∏—Å–ª–∞

–ú–∏–Ω–∏–º–∞–ª—å–Ω–æ –∞–¥—Ä–µ—Å—É–µ–º–æ–π –µ–¥–∏–Ω–∏—Ü–µ–π —è–≤–ª—è–µ—Ç—Å—è –±–∞–π—Ç. –°–∫–æ–ª—å–∫–æ –±–∏—Ç –≤ –±–∞–π—Ç–µ? 

–û—Ç–≤–µ—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç—Å—è –≤ –∫–æ–Ω—Å—Ç–∞–Ω—Ç–µ `CHAR_BIT` –∏–∑ `limits.h`. –ü–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç—É –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç—Å—è, —á—Ç–æ —Ö–æ—Ç—è –±—ã 8. –û–¥–Ω–æ–±–∞–π—Ç–æ–≤—ã–π —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è `char`.

–¢–∏–ø—ã, –∫–æ—Ç–æ—Ä—ã–º–∏ –≤—ã –ø—Ä–∏–≤—ã–∫–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è, —Ç–∞–∫–∏–µ –∫–∞–∫ `int` –ø–ª–æ—Ö–∏ —Ç–µ–º, —á—Ç–æ –Ω–∞ —Ä–∞–∑–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö –∑–∞–Ω–∏–º–∞—é—Ç —Ä–∞–∑–Ω–æ–µ —á–∏—Å–ª–æ –±–∞–π—Ç (–Ω–∞ 32-–±–∏—Ç–Ω—ã—Ö –æ–±—ã—á–Ω–æ 4, –Ω–∞ 64-–±–∏—Ç–Ω—ã—Ö 8).

–ß—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –≤—Å–µ–π —ç—Ç–æ–π –ø—É—Ç–∞–Ω–∏—Ü—ã, –¥–∞–ª–µ–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–∏–ø—ã —Å —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–º —á–∏—Å–ª–æ–º –±–∏—Ç: `int8_t`, `uint16_t` –∏ —Ç–∞–∫ –¥–∞–ª–µ–µ. –û–Ω–∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –≤ `stdint.h`.

–î–∞–≤–∞–π—Ç–µ —Å –ø–æ–º–æ—â—å—é –Ω–µ–±–æ–ª—å—à–æ–π –¥–µ–º–∫–∏ (`print_int.c`) –ø–æ—Å–º–æ—Ç—Ä–∏–º –Ω–∞ —Ç–æ, –∫–∞–∫ —ç—Ç–∏ —á–∏—Å–ª–∞ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –ø–∞–º—è—Ç–∏.

–í–æ–∑—å–º—ë–º 8-–±–∏—Ç–Ω–æ–µ –±–µ–∑–∑–Ω–∞–∫–æ–≤–æ–µ —á–∏—Å–ª–æ, –∫–∞–∫ —Å–∞–º—ã–π –ø—Ä–æ—Å—Ç–æ–π –ø—Ä–∏–º–µ—Ä. –í –Ω—ë–º –±–∏—Ç—ã –ø—Ä–æ—Å—Ç–æ –∑–∞–¥–∞—é—Ç –¥–≤–æ–∏—á–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —á–∏—Å–ª–∞, –Ω–∞—á–∏–Ω–∞—è —Å–æ —Å—Ç–∞—Ä—à–∏—Ö —Ä–∞–∑—Ä—è–¥–æ–≤.

–ù–∞ –ø—Ä–∏–º–µ—Ä–µ 8-–±–∏—Ç–Ω—ã—Ö –∑–Ω–∞–∫–æ–≤—ã—Ö –º—ã –≤–∏–¥–∏–º, —á—Ç–æ –ø–µ—Ä–≤—ã–π –±–∏—Ç –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –∑–Ω–∞–∫ (0 –¥–ª—è –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã—Ö, 1 –¥–ª—è –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã—Ö). –î–∞–ª–µ–µ –¥–ª—è –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–≥–æ —á–∏—Å–ª–∞ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –Ω–µ –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è. –î–ª—è –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–≥–æ –æ–Ω–æ –ø–æ–ª—É—á–∞–µ—Ç—Å—è –∏–∑ —Å–æ–æ–±—Ä–∞–∂–µ–Ω–∏—è, —á—Ç–æ `(-x)+x=0`. –ù–∞ —Å–∞–º–æ–º –¥–µ–ª–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏–µ –∏ —Å—Ç–∞—Ä—à–∏–π –±–∏—Ç –æ—Ç–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è. –î–ª—è —á–∏—Å–µ–ª —Å –±–æ–ª—å—à–µ–π —Ä–∞–∑—Ä—è–¥–Ω–æ—Å—Ç—å—é –ø—Ä–æ—Å—Ç–æ –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è —Å—Ç–∞—Ä—à–∏–µ –±–∞–π—Ç—ã –≤ –Ω–∞—á–∞–ª–æ. `x86` –ø–æ—ç—Ç–æ–º—É –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è `Little-endian` –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π. –ü—Ä–∏ –ø–µ—Ä–µ–¥–∞—á–µ –ø–æ —Å–µ—Ç–∏ –Ω–∞–æ–±–æ—Ä–æ—Ç –ø—Ä–∏–Ω—è—Ç–æ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å —Å—Ç–∞—Ä—à–∏–µ –±–∞–π—Ç—ã –≤ –Ω–∞—á–∞–ª–µ, –º–æ–∂–Ω–æ –ø—Ä–∏–≤–µ—Å—Ç–∏ —á–∏—Å–ª–æ –∫ —Ç–∞–∫–æ–º—É –≤–∏–¥—É —Å –ø–æ–º–æ—â—å—é —Ñ—É–Ω–∫—Ü–∏–∏ `htons` –∏ —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –ø–æ—Ä—è–¥–æ–∫ –∏–∑–º–µ–Ω–∏–ª—Å—è.

## UBSAN

–ü–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–Ω–∞–∫–æ–≤–æ–≥–æ —Ç–∏–ø–∞ —è–≤–ª—è–µ—Ç—Å—è –Ω–µ–æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–º –ø–æ–≤–µ–¥–µ–Ω–∏–µ–º –ø–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç—É. –ß—Ç–æ–±—ã —ç—Ç–æ –æ—Ç–ª–∞–≤–ª–∏–≤–∞—Ç—å, –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ñ–ª–∞–≥ ``-fsanitize=undefined`` –ø—Ä–∏ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ (—Å–º. ``overflow.c``).

## –í–µ—â–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —á–∏—Å–ª–∞

–î–≤–∞ –æ—Å–Ω–æ–≤–Ω—ã—Ö —Ç–∏–ø–∞ –≤–µ—â–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Å –ø–ª–∞–≤–∞—é—â–µ–π —Ç–æ—á–∫–æ–π, –∫–æ—Ç–æ—Ä—ã–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã —Å—Ç–∞–Ω–¥–∞—Ä—Ç–æ–º —è–∑—ã–∫–∞ –°–∏, - —ç—Ç–æ `float` (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è 4 –±–∞–π—Ç–∞ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è) –∏ `double` (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è 8 –±–∞–π—Ç).

–î–ª—è –ø—Ä–æ—Å—Ç–æ—Ç—ã –¥–∞–ª–µ–µ –±—É–¥–µ—Ç —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–∞—Ç—å `float` (—Å–º. ``print_float.c``). –í–∏–¥–∏–º–æ, —á—Ç–æ —Å—Ç–∞—Ä—à–∏–π –±–∏—Ç –≤–Ω–æ–≤—å –ø—Ä–∏–∑–Ω–∞–∫ –æ—Ç—Ä–µ—Ü–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —á–∏—Å–ª–∞. –°–ª–µ–¥—É—é—â–∏–µ 8 –±–∏—Ç –Ω–∞–∑—ã–≤–∞—é—Ç—Å—è —ç–∫—Å–ø–æ–Ω–µ–Ω—Ç–æ–π, –∞ –æ—Å—Ç–∞–≤—à–∏–µ—Å—è 23 - –º–∞–Ω—Ç–∏—Å—Å–æ–π.

–ó–Ω–∞—á–µ–Ω–∏–µ –µ–≥–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø–æ–ª—É—á–µ–Ω–æ –∫–∞–∫:

```
Value = (-1)^S * 2^(E-B) * ( 1 + M / (2^(M_bits-1)) )
```
–≥–¥–µ `S` - –±–∏—Ç –∑–Ω–∞–∫–∞, `E` - –∑–Ω–∞—á–µ–Ω–∏–µ —Å–º–µ—â–µ–Ω–Ω–æ–π —ç–∫—Å–ø–æ–Ω–µ–Ω—Ç—ã, `B` - —Å–º–µ—â–µ–Ω–∏–µ (127 –∏–ª–∏ 1023), –∞ `M` - –∑–Ω–∞—á–µ–Ω–∏–µ –º–∞–Ω—Ç–∏—Å—Å—ã, `M_bits` - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–∏—Ç –≤ —ç–∫—Å–ø–æ–Ω–µ–Ω—Ç–µ.

–ú–æ–∂–Ω–æ —Ä–∞–∑–±–∏—Ä–∞—Ç—å —á–∏—Å–ª–æ —Å –ø–æ–º–æ—â—å—é ``union`` (—Å–º. ``print_union.c``).

> –ö—Ä–∞—Å–∏–≤—ã–π –≤–∏–∑—É–∞–ª–∏–∑–∞—Ç–æ—Ä: https://www.h-schmidt.net/FloatConverter/IEEE754.html

## –¢–µ–∫—Å—Ç–æ–≤—ã–µ –∫–æ–¥–∏—Ä–æ–≤–∫–∏

![ASCII](ascii.png)

–í —Å–µ—Ä–µ–¥–∏–Ω–µ 20 –≤–µ–∫–∞ –≤–æ–∑–Ω–∏–∫–ª–∞ –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç—å –∫–∞–∫-—Ç–æ –∫–æ–¥–∏—Ä–æ–≤–∞—Ç—å —Ç–µ–∫—Å—Ç –¥–≤–æ–∏—á–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏. –¢–æ–≥–¥–∞ —Ä–µ—à–∏–ª–∏, —á—Ç–æ 7 –±–∏—Ç –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –Ω–∞ —Ü–∏—Ñ—Ä—ã –∏ –ª–∞—Ç–∏–Ω—Å–∫–∏–π –∞–ª—Ñ–∞–≤–∏—Ç, —Ç–∞–∫ –∏ –ø–æ—è–≤–∏–ª–∞—Å—å –∫–æ–¥–∏—Ä–æ–≤–∫–∞ ASCII.

–ü–æ–∑–∂–µ –æ–¥–∏–Ω –ª–∏—à–Ω–∏–π –±–∏—Ç –ø–æ–∑–≤–æ–ª–∏–ª —Ö—Ä–∞–Ω–∏—Ç—å –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ –æ—Ç 128 –¥–æ 255 —Å–∏–º–≤–æ–ª—ã –Ω–∞—Ü–∏–æ–Ω–∞–ª—å–Ω—ã—Ö –∫–æ–¥–∏—Ä–æ–≤–æ–∫. –í –†–æ—Å—Å–∏–∏, –Ω–∞–ø—Ä–∏–º–µ—Ä, –≤ 90-–µ –±—ã–ª–∞ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∞ `KOI8-R`.

–ò–º–µ—Ç—å –æ—Ç–¥–µ–ª—å–Ω—É—é –∫–æ–¥–∏—Ä–æ–≤–∫—É –ø–æ–¥ –∫–∞–∂–¥—ã–π —è–∑—ã–∫ –≤—Å—ë –µ—â—ë –±—ã–ª–æ –Ω–µ –æ—á–µ–Ω—å —É–¥–æ–±–Ω–æ, –ø–æ—ç—Ç–æ–º—É –ø–æ—è–≤–∏–ª–∞—Å—å `UTF-8`. –ß—Ç–æ–±—ã –Ω–µ –∑–∞–Ω–∏–º–∞—Ç—å –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ 4 –æ–∫—Ç–µ—Ç–∞ (–±—É–¥–µ–º –Ω–∞–∑—ã–≤–∞—Ç—å —Ç–∞–∫ –≥—Ä—É–ø–ø—ã ), –±—ã–ª –ø—Ä–∏–¥—É–º–∞–Ω –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–π –¥–∏–∑–∞–π–Ω. 

``echo 'C' | hexdump -C`` (`0a` –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –ø–µ—Ä–µ–≤–æ–¥ —Å—Ç—Ä–æ–∫–∏, –ø–æ —Å—É—Ç–∏ –µ—Å—Ç—å –æ–¥–∏–Ω –∑–Ω–∞—á–∞—â–∏–π –±–∞–π—Ç `43` –∏ –∫–æ–¥ —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å ASCII)

–¢–æ –µ—Å—Ç—å –¥–ª—è —Å–∞–º—ã—Ö —á–∞—Å—Ç–æ—Ç–Ω—ã—Ö —Ç–µ–∫—Å—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –Ω–∞–ø–∏—Å–∞–Ω—ã –ª–∞—Ç–∏–Ω–∏—Ü–µ–π, –æ–Ω–∞ –∑–∞–Ω–∏–º–∞–µ—Ç —Å—Ç–æ–ª—å–∫–æ –∂–µ –º–µ—Å—Ç–æ, —Å–∫–æ–ª—å–∫–æ ASCII.

``echo '–Ø' | hexdump -C`` (–ë–∞–π—Ç—ã `d0` `af` –æ—Ç–≤–µ—á–∞—é—Ç –∑–∞ `–Ø`)

–î–ª—è –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ —è–∑—ã–∫–æ–≤ —Ö–≤–∞—Ç–∞–µ—Ç –¥–≤—É—Ö –±–∞–π—Ç.

``echo 'üòä' | hexdump -C`` 

4 –±–∞–π—Ç–∞ –Ω—É–∂–Ω–æ –¥–ª—è –∫–∞–∫–∏—Ö-—Ç–æ —Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏—Ö —Å–∏–º–≤–æ–ª–æ–≤.

–í –æ–±—â–µ–º —Å–ª—É—á–∞–µ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥—á–∏–Ω—è–µ—Ç—Å—è —Å–ª–µ–¥—É—é—â–∏–º —à–∞–±–ª–æ–Ω–∞–º.

| –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–∫—Ç–µ—Ç–æ–≤ | –®–∞–±–ª–æ–Ω |
|---|---|
|1|0xxxxxxx|
|2|110xxxxx 10xxxxxx|
|3|1110xxxx 10xxxxxx 10xxxxxx|
|4|11110xxx 10xxxxxx 10xxxxxx 10xxxxxx|
